!function(t){t.Paddler={}}(window),function(t,e){function i(t,e,i,n,s,o){this._id=t,this._username=e,this._firstName=i,this._lastName=n,this._email=s,this._profile=o}function n(t,e,i,n,s,o,r,a,u){this._picture=t,this._birthdate=e,this._gender=i,this._height=n,this._weight=s,this._country=o,this._language=r,this._units=a,this._debug=u}var s=new e("gopaddler",8,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890");i.prototype.getId=function(){return this._id},i.prototype.getHashId=function(){return s.encode(this._id)},i.prototype.getUsername=function(){return this._username},i.prototype.getFirstName=function(){return this._firstName},i.prototype.getLastName=function(){return this._lastName},i.prototype.getFullName=function(){var t=this._firstName;return t?t&&this._lastName&&(t+=" "+this._lastName):t=this._lastName,t||this._username},i.prototype.getEmail=function(){return this._email},i.prototype.getProfile=function(){return this._profile},i.prototype.fromData=function(t){return t?(this._id=t.id,this._username=t.username,this._firstName=t.first_name,this._lastName=t.last_name,this._email=t.email,this._profile=(new n).fromData(t.profile),this):this},i.prototype.toData=function(){return{id:this._id,username:this._username,first_name:this._firstName,last_name:this._lastName,email:this._email,profile:this._profile?this._profile.toData():{}}},i.prototype.serialize=function(){return JSON.stringify(this.toData())},i.prototype.unserialize=function(t){return this.fromData(JSON.parse(t)),this},n.prototype.fromData=function(t){return t?(this._picture=t.picture_url||t.picture,this._birthdate=t.birthdate,this._gender=t.gender,this._height=t.height,this._weight=t.weight,this._country=t.country,this._language=t.language,this._units=t.units,this._debug=t.debug,this):this},n.prototype.toData=function(){return{picture:this._picture,birthdate:this._birthdate,gender:this._gender,height:this._height,weight:this._weight,country:this._country,language:this._language,units:this._units,debug:this._debug}},n.prototype.getPicture=function(){return this._picture},n.prototype.getBirthdate=function(){return this._birthdate},n.prototype.getGender=function(){return this._gender},n.prototype.getHeight=function(){return this._height},n.prototype.getWeight=function(){return this._weight},n.prototype.getCountry=function(){return this._country},n.prototype.getLanguage=function(){return this._language},n.prototype.getUnits=function(){return this._units},n.prototype.isDebug=function(){return this._debug},t.User=i}(Paddler,Hashids),function(t){function e(t,e,i,n,s,o,r,a,u,p,c,h,f,_,d,g){this._id=t,this._description=e,this._date=i,this._duration=n,this._distance=s,this._avgSpeed=o,this._maxSpeed=r,this._avgSpm=a,this._maxSpm=u,this._data=p,this._angleZ=c,this._noiseX=h,this._noiseZ=f,this._factorX=_,this._factorZ=d,this._axis=g}function i(t,e,i,n,s){this._timestamp=t,this._distance=e,this._speed=i,this._spm=n,this._spmEfficiency=s}e.prototype.getId=function(){return this._id},e.prototype.setId=function(t){this._id=t},e.prototype.getDescription=function(){return this._description},e.prototype.setDescription=function(t){this._description=t},e.prototype.getDate=function(){return this._date},e.prototype.setDate=function(t){this._date=t},e.prototype.getDuration=function(){return this._duration},e.prototype.setDuration=function(t){this._duration=t},e.prototype.getDistance=function(){return this._distance},e.prototype.setDistance=function(t){this._distance=t},e.prototype.getAvgSpeed=function(){return this._avgSpeed},e.prototype.setAvgSpeed=function(t){this._avgSpeed=t},e.prototype.getMaxSpeed=function(){return this._maxSpeed},e.prototype.setMaxSpeed=function(t){this._maxSpeed=t},e.prototype.getAvgSpm=function(){return this._avgSpm},e.prototype.setAvgSpm=function(t){this._avgSpm=t},e.prototype.getMaxSpm=function(){return this._maxSpm},e.prototype.setMaxSpm=function(t){this._maxSpm=t},e.prototype.getData=function(){return this._data},e.prototype.setData=function(t){this._data=t},e.prototype.getAngleZ=function(){return this._angleZ},e.prototype.setAngleZ=function(t){this._angleZ=t},e.prototype.getNoiseX=function(){return this._noiseX},e.prototype.setNoiseX=function(t){this._noiseX=t},e.prototype.getNoiseZ=function(){return this._noiseZ},e.prototype.setNoiseZ=function(t){this._noiseZ=t},e.prototype.getNoiseX=function(){return this._noiseX},e.prototype.setNoiseX=function(t){this._noiseX=t},e.prototype.getFactorX=function(){return this._factorX},e.prototype.setFactorX=function(t){this._factorX=t},e.prototype.getFactorZ=function(){return this._factorZ},e.prototype.setFactorZ=function(t){this._factorZ=t},e.prototype.getAxis=function(){return this._axis},e.prototype.setAxis=function(t){this._axis=t},e.prototype.fromData=function(t){if(!t)return this;var e,n;if(this._id=t.id,this._description=t.description,this._date=t.date,this._duration=t.duration,this._distance=t.distance,this._avgSpeed=t.avg_speed,this._maxSpeed=t.max_speed,this._avgSpm=t.avg_spm,this._maxSpm=t.max_spm,this._data=[],t.training_session_data&&t.training_session_data.length)for(e=0,n=t.training_session_data.length;n>e;e++)this._data.push((new i).fromData(t.training_session_data[e]));return this._angleZ=t.angle_z,this._noiseX=t.noise_x,this._noiseZ=t.noise_z,this._factorX=t.factor_x,this._factorZ=t.factor_z,this._axis=t.axis,this},e.prototype.toData=function(){var t,e,i=void 0;if(this._data&&this._data.length)for(i=[],t=0,e=this._data.length;e>t;t++)i.push(this._data[t].toData());return{id:this._id,description:this._description,date:this._date,duration:this._duration,distance:this._distance,avg_speed:this._avgSpeed,max_speed:this._maxSpeed,avg_spm:this._avgSpm,max_spm:this._maxSpm,training_session_data:i,angle_z:this._angleZ,noise_x:this._noiseX,noise_z:this._noiseZ,factor_x:this._factorX,factor_z:this._factorZ,axis:this._axis}},i.prototype.getTimestamp=function(){return this._timestamp},i.prototype.setTimestamp=function(t){this._timestamp=t},i.prototype.getDistance=function(){return this._distance},i.prototype.setDistance=function(t){this._distance=t},i.prototype.getSpeed=function(){return this._speed},i.prototype.setSpeed=function(t){this._speed=t},i.prototype.getSpm=function(){return this._spm},i.prototype.setSpm=function(t){this._spm=t},i.prototype.getSpmEfficiency=function(){return this._spmEfficiency},i.prototype.setSpmEfficiency=function(t){this._spmEfficiency=t},i.prototype.fromData=function(t){return t?(this._timestamp=t.timestamp,this._distance=t.distance,this._speed=t.speed,this._spm=t.spm,this._spmEfficiency=t.spm_efficiency,this):this},i.prototype.toData=function(){return{timestamp:this._timestamp,distance:this._distance,speed:this._speed,spm:this._spm,spm_efficiency:this._spmEfficiency}},t.TrainingSession=e,t.TrainingSessionData=i}(Paddler),function(t){function e(t,e,i,n,s){this._timestamp=t,this._x=e,this._y=i,this._z=n,this._value=s}e.prototype.getTimestamp=function(){return this._timestamp},e.prototype.setTimestamp=function(t){this._timestamp=t},e.prototype.getX=function(){return this._x},e.prototype.setX=function(t){this._x=t},e.prototype.getY=function(){return this._y},e.prototype.setY=function(t){this._y=t},e.prototype.getZ=function(){return this._z},e.prototype.setZ=function(t){this._z=t},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(t){this._value=t},e.prototype.fromData=function(t){return t?(this._timestamp=t.timestamp,this._x=t.x,this._y=t.y,this._z=t.z,this._value=t.value,this):this},e.prototype.toData=function(){return{timestamp:this._timestamp,x:this._x,y:this._y,z:this._z,value:this._value}},t.DebugSessionData=e}(Paddler),function(t){t.DebugSessions={saveMultiple:function(e,i){var n,s,o=[];for(n=0,s=i.length;s>n;n++)o.push(i[n].toData());return t.Remote.post("/debug/"+e,o)}}}(Paddler),function(t,e){t.Session={_user:null,_accessToken:null,init:function(){var i=e.localStorage.getItem("accessToken"),n=e.localStorage.getItem("user");this._user=n?(new t.User).unserialize(n):null,this._accessToken=i?i:null},setUser:function(t){return this._user=t,t?e.localStorage.setItem("user",t.serialize()):e.localStorage.removeItem("user"),this},getUser:function(){return this._user},setAccessToken:function(t){return this._accessToken=t,t?e.localStorage.setItem("accessToken",t):e.localStorage.removeItem("accessToken"),this},getAccessToken:function(){return this._accessToken},destroy:function(){this.setUser(null),this.setAccessToken(null)}}}(Paddler,window),function(t,e){function i(t){return-1===t.indexOf("/",t.length-1)&&(t+="/"),p+t}function n(t){if("object"==typeof t)for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];i&&"object"==typeof i&&i.hasOwnProperty("__timestamp")?isNaN(i.__timestamp)||(t[e]=new Date(i.__timestamp)):"object"==typeof i&&n(i)}}function s(t){var e,i,n=new FormData;for(e in t)t.hasOwnProperty(e)&&(i=t[e],"object"==typeof i?o(n,e,i):n.append(e,i));return n}function o(t,e,i){var n,s;for(n in i)i.hasOwnProperty(n)&&(s=i[n],void 0!==s&&t.append(e+"."+n,s))}function r(t){var e,i,n={};if(t&&t instanceof Array)return a(t);for(e in t)t.hasOwnProperty(e)&&(i=t[e],i&&i instanceof Date?n[e]={__timestamp:i.getTime()}:i&&i instanceof Array?n[e]=a(i):i&&"object"==typeof i?n[e]=r(i):void 0!==i&&(n[e]=i));return n}function a(t){var e,i,n=[];for(e=0,i=t.length;i>e;e++)n.push(r(t[e]));return n}function u(o,a,u,p){var c=p||new h,f=r(u),_=e.Deferred(),d={type:o,url:i(a),data:JSON.stringify(f),contentType:"application/json",headers:{Authorization:t.Session.getAccessToken()?"JWT "+t.Session.getAccessToken():void 0}};return c.isFileUpload()&&(d.data=s(f),d.processData=!1,d.contentType=!1),e.ajax(d).done(function(t,e,i){n(t),_.resolve({status:i.status,statusText:i.statusText,data:t})}).fail(function(t){var e,i=t.response?JSON.parse(t.response):t.response;i&&i.error?e=i.error:i&&(e=i),_.reject({status:t.status,statusText:t.statusText,error:e})}),_.promise()}var p="http://212.47.250.49/api",c=[],h=function(t){this._fileUpload=!!t};h.prototype.setFileUpload=function(t){this._fileUpload=!!t},h.prototype.isFileUpload=function(){return!!this._fileUpload},t.Remote={get:function(t,e,i){return e instanceof h&&(i=e,e=void 0),u("get",t,e,i)},post:function(t,e,i){return u("post",t,e,i)},put:function(t,e,i){return u("put",t,e,i)},"delete":function(t,e,i){return u("delete",t,e,i)},registerErrorHandler:function(t){c.push(t)},Options:h},t.Deferred=e.Deferred}(Paddler,jQuery),function(t,e){function i(e){var i=e.token,n=(new t.User).fromData(e.user);return t.Session.setAccessToken(i),t.Session.setUser(n),n}t.Authentication={isAuthenticated:function(){return null!==t.Session.getUser()},registration:function(e,i,n,s){return t.Remote.post("/auth/registration",{username:e,password1:i,password2:n,email:s})},login:function(e,n){return t.Remote.post("/auth/login",{username:e,password:n}).done(function(t){return i(t.data)})},fbLogin:function(e){return t.Remote.post("/auth/fb-login",{access_token:e}).done(function(t){return i(t.data)})},logout:function(){return t.Session.destroy(),t.Deferred().resolve(!0)},autoLogin:function(e){var n=t.Deferred();return t.Session.init(),t.Session.getAccessToken()?t.Remote.post("/auth/refresh-token",{token:t.Session.getAccessToken()}).done(function(t){n.resolve(i(t.data))}).fail(function(){e?n.resolve(t.Session.getUser()):(t.Session.destroy(),n.reject())}):(t.Session.destroy(),n.reject()),n.promise()},getUser:function(){return t.Remote.get("/auth/user").then(function(e){var i=(new t.User).fromData(e.data);return t.Session.setUser(i),i})},userSave:function(e){return t.Remote.put("/auth/user",e,new t.Remote.Options(!0)).then(function(e){var i=(new t.User).fromData(e.data);return t.Session.setUser(i),i})},saveUserDevice:function(e){var i=t.Session.getUser();return"string"!=typeof e&&(e=JSON.stringify(e)),t.Remote.put("/auth/user",{id:i.getId(),profile:{device:e,country:i.getProfile().getCountry()}})},recoverPassword:function(e){return t.Remote.post("/auth/password/reset/",{email:e})},recoverPasswordConfirm:function(e,i,n,s){return t.Remote.post("/auth/password/reset/confirm",{uid:e,token:i,new_password1:n,new_password2:s})}}}(Paddler,window),function(t,e){function i(t){var e,i,s=[];if(t&&t.length)for(e=0,i=t.length;i>e;e++)s.push(n(t[e]));return s}function n(e){return e?(new t.TrainingSession).fromData(e):null}t.TrainingSessions={getAll:function(){var n=e.Deferred();return t.Remote.get("/training-sessions").done(function(t){n.resolve(i(t.data))}).fail(function(t){n.reject(t)}),n.promise()},getAllByMonth:function(n,s){var o=e.Deferred();return t.Remote.get("/training-sessions/"+n+"/"+s+"/").done(function(t){o.resolve(i(t.data))}).fail(function(t){o.reject(t)}),o.promise()},get:function(i){var s=e.Deferred();return t.Remote.get("/training-sessions/"+i).done(function(t){s.resolve(n(t.data))}).fail(function(t){s.reject(t)}),s.promise()},save:function(i){var s,o=e.Deferred();return s=i.getId()?t.Remote.put("/training-sessions/"+i.getId(),i.toData()):t.Remote.post("/training-sessions",i.toData()),s.done(function(t){o.resolve(n(t.data))}).fail(function(t){o.reject(t)}),o.promise()},"delete":function(e){return t.Remote["delete"]("/training-sessions/"+e)}}}(Paddler,jQuery);